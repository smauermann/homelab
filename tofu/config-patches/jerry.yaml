---
# yaml-language-server: $schema=https://www.talos.dev/v1.8/schemas/v1alpha1_config.schema.json
machine:
  install:
    disk: /dev/nvme0n1
    extraKernelArgs:
      - i915.force_probe=7d55 # TODO: Remove this once the kernel is updated to 6.8.0
      - apparmor=0
      - mitigations=off
      - security=none
      - cpufreq.default_governor=powersave
    image: ${image}-12234
    wipe: false
  disks:
    - device: /dev/nvme0n1
      partitions:
        - mountpoint: /var/mnt/storage
  udev:
    rules:
       - SUBSYSTEM=="drm", KERNEL=="renderD*", GROUP="44", MODE="0660"
  network:
    hostname: talos-jerry
    interfaces:
      - interface: eno1
        mtu: 9000
        dhcp: true
  kubelet:
    extraMounts:
     - destination: /var/mnt/storage
       type: bind
       source: /var/mnt/storage
       options: ["bind", "rshared", "rw"]
  nodeLabels:
    topology.kubernetes.io/region: main
    topology.kubernetes.io/zone: jerry
